define("jira/project/browse/projectcollectionview",["jquery","jira/backbone.radio-2.0","jira/marionette-4.1","jira/util/formatter","jira/util/users/logged-in-user","jira/util/data/meta","jira/project/browse/projectview","jira/project/project-type-keys","jira/project/browse/projects-empty-view","jira/project/browse/projects-empty-view-with-action","jira/project/browse/archived-projects-empty-view"],function(e,t,i,r,o,c,s,n,l,a,d){"use strict";return i.CollectionView.extend({template:JIRA.Templates.Project.Browse.projects,templateContext:function(){return{isAdmin:o.isSysadmin()||o.isAdmin(),isAdminMode:c.get("in-admin-mode")}},events:{"click th.sortable":function(t){this._sort(e(t.currentTarget).data("sort-key"))}},childView:s,childViewContainer:"tbody",childViewEvents:{"project-view.click-project-name":function(e){var t=e.model,i=this.collection.indexOf(t);this.trigger("project-view.click-project-name",t,i),this.analyticsChannel.trigger("browse-projects.project-view.click-project-name",t,i)},"project-view.click-lead-user":function(e){var t=e.model,i=this.collection.indexOf(t);this.trigger("project-view.click-lead-user",t,i),this.analyticsChannel.trigger("browse-projects.project-view.click-lead-user",t,i)},"project-view.click-category":function(e){var t=e.model,i=this.collection.indexOf(t);this.triggerMethod("project-view.click-category",t,i),this.analyticsChannel.trigger("browse-projects.project-view.click-category",t,i)},"project-view.click-url":function(e){var t=e.model,i=this.collection.indexOf(t);this.trigger("project-view.click-url",t,i),this.analyticsChannel.trigger("browse-projects.project-view.click-url",t,i)}},emptyViewOptions:function(){return{filters:this.model,hasArchivedProjects:this.hasArchivedProjects()}},emptyView:function(){return this.hasArchivedProjects()||"archived"!==this.model.get("category").id?this.shouldUseCallToActionTemplate()?a:l:d},initialize:function(){this.analyticsChannel=t.channel("browse-projects-analytics")},onRender:function(){this.unwrapTemplate()},_sort:function(e){"ascending"===this.model.get("sortOrder")&&this.model.get("sortColumn")===e?this.model.set("sortOrder","descending"):(this.model.set("sortOrder","ascending"),this.model.set("sortColumn",e)),this.collection.updateSorting(e,this.model.get("sortOrder")),this.trigger("sorted",e,this.model.get("sortOrder")),this.render()},hasArchivedProjects:function(){return!!this.model.filterByCategory("archived",this.collection.originalCollection).length},shouldUseCallToActionTemplate:function(){var e=[n.SOFTWARE,n.SERVICE_DESK,n.BUSINESS];return this.model.get("projectType")&&"all"===this.model.get("category").id&&""===this.model.get("contains")&&-1!==e.indexOf(this.model.get("projectType").key)}})});