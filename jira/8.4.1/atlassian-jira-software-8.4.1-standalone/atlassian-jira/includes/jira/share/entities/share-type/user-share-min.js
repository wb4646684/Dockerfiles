define("jira/share/entities/share-type/user-share",["jira/share/entities/display","jira/share/entities/share-permission","jira/share/i18n","jquery"],function(e,t,s,r){"use strict";function i(e){this.type="user",this.singleton=!1,this.parentElement=document.querySelector("."+e),this.userKey=null,this.singleSelectController=null,this.dirty=!1}return i.prototype={initialise:function(){var e=this;this.userSelect=this.getSubElement("user-share-select"),this.userSelect&&r(this.userSelect).on("selected",function(t,s,r){e.userKey=s.properties?s.properties.userKey:s.value(),e.userSelect.selectedOptions&&(i.lastOption=e.userSelect.selectedOptions[0]),e.dirty=!0,e.singleSelectController||(e.singleSelectController=r)})},getDisplayDescriptionFromUI:function(){return""},getDisplayFromUI:function(s){var r=null;if(this.singleSelectController&&this.userKey){s||this.singleSelectController.clear();var i=new t(this.type,this.userKey,null);r=new e(this.getDisplayString(this.userKey),this.getDescriptionString(this.userKey,!0),this.singleton,i,this.userKey)}return r},inputChangesExist:function(){return this.dirty},getDisplayString:function(e){var t=s.getMessage("share_user_display");return s.formatMessage(t,e)},getDescriptionString:function(e,t){var r=s.getMessage("share_user_description");return t?s.formatMessageUnescaped(r,e):s.formatMessage(r,e)},getDisplayFromPermission:function(s){if(!s||s.type!==this.type||!s.param1)return null;var r=new t(this.type,s.param1,null);return new e(this.getDisplayString(r.param1),this.getDescriptionString(s.param1,!0),this.singleton,r,r.param1)},getDisplayWarning:function(){return""},getSubElement:function(e){return this.parentElement.querySelector("."+e)},updateSelectionFromPermission:function(e){var t=i.lastOption;t&&e.param1===t.value&&this.userSelect.append(t)}},i});